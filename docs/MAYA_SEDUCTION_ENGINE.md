# üöÄ Maya Seduction Engine - Sistema de Notificaciones Inteligentes

## üéØ Visi√≥n General

El **Maya Seduction Engine** es el sistema de notificaciones push automatizadas que convierte pacientes potenciales en pacientes comprometidos mediante neuroventas y timing perfecto.

---

## üì± Tres Tipos de Notificaciones

### 1. PUSH DE AUTORIDAD (El Or√°culo) üî¨

**Objetivo**: Establecer que "vemos" lo que ellos no ven ‚Üí Dependencia saludable

**Ejemplo**:
```
üî¨ El Dr. Maya Detect√≥ Algo

Juan, el algoritmo Maya ha detectado un descenso en su 
√≠ndice de col√°geno (38%) seg√∫n su √∫ltima dieta. El Dr. 
Maya ha actualizado su prescripci√≥n en la App. Rev√≠sela ahora.

[Principio Neurol√≥gico]
Autoridad Cient√≠fica + Ver lo invisible = Dependencia saludable

[Fuente Cient√≠fica]
Byung Pal Yu - Epigenetic Modulation
```

### 2. PUSH DE ESCASEZ (Gatillo de Dopamina) ‚è∞

**Objetivo**: Activar FOMO y urgencia ‚Üí Decisi√≥n acelerada

**Ejemplo**:
```
‚è∞ Ventana de Oportunidad Cerrando

Mar√≠a, su ventana de recuperaci√≥n √≥ptima para el 
facelift de Connell se cierra en 3 d√≠as. Solo quedan 
2 espacios de quir√≥fano con protocolo ERAS de alta seguridad.

[Principio Neurol√≥gico]
FOMO + Escasez artificial = Decisi√≥n acelerada

[Fuente Cient√≠fica]
ERAS Complete Protocols + Bruce Connell
```

### 3. PUSH DE RECOMPENSA EPIGEN√âTICA (Gamificaci√≥n) üéâ

**Objetivo**: Reforzar comportamiento positivo ‚Üí Compra recurrente

**Ejemplo**:
```
üéâ ¬°Transformaci√≥n Epigen√©tica Detectada!

¬°Felicidades Pedro! Sus marcadores de inflamaci√≥n (NFŒ∫B) 
han mejorado 15% gracias a su kit de Interdrogas. 
Actual: 55%. Est√° entrando en la zona de '√âxito Quir√∫rgico'.

[Principio Neurol√≥gico]
Recompensa dopam√≠nica + Gamificaci√≥n = Compra recurrente

[Fuente Cient√≠fica]
Oxidative Stress and Mitochondrial Health
```

---

## üé≠ Flujo de 7 D√≠as - The Seduction

### D√çA 1: EL DESPERTAR (Curiosidad + Autoridad)

**Trigger**: Activaci√≥n de cuenta / Retoma de Base Luxury

**Mensaje**:
```
üîÆ Dr. Maya Ha Digitalizado Su Historial

Hola Mar√≠a, el Dr. Maya ha digitalizado su historial 
biol√≥gico. Su perfil ha sido seleccionado para el nuevo 
escaneo de Resonancia Cu√°ntica. ¬øSabe cu√°l es su edad 
celular real hoy?
```

**Deep Link**: `/patient-app` ‚Üí Dashboard Maya Bio-Mirror

**Principio**: Curiosidad + Selecci√≥n exclusiva = Apertura mental

---

### D√çA 2: LA REVELACI√ìN (Ciencia Epigen√©tica)

**Mensaje**:
```
üß¨ El 80% de Su Envejecimiento es Reversible

¬øSab√≠a que el 80% de su envejecimiento no es gen√©tica, 
sino estilo de vida? El Dr. Maya ha implementado protocolos 
para silenciar los genes de la inflamaci√≥n. Vea c√≥mo podemos 
optimizar su ADN.
```

**Deep Link**: `/patient-app/education/epigenetics` ‚Üí Video educativo

**Fuente**: Byung Pal Yu - Nutrition Exercise and Epigenetics

**Principio**: Estad√≠stica sorprendente + Soluci√≥n tangible = Engagement

---

### D√çA 3: EL ESPEJO DEL FUTURO (Simetr√≠a)

**Mensaje**:
```
üíé Su Proporci√≥n √Åurea Personalizada

La verdadera belleza es simetr√≠a y salud √≥sea. Hemos 
preparado una simulaci√≥n de su "Potencial de Proporci√≥n 
√Åurea". Entre a la App y descubra su versi√≥n arquitect√≥nica 
perfecta.
```

**Deep Link**: `/patient-app/maya-vision/simulation` ‚Üí Simulaci√≥n 3D

**Fuente**: Bruce Connell + Onelio Garcia Jr - Facial Harmony

**Principio**: Visualizaci√≥n del yo ideal + Arquitectura √≥sea = Deseo

---

### D√çA 4: PRUEBA SOCIAL Y SEGURIDAD (ERAS)

**Mensaje**:
```
‚ú® Caso de √âxito: -5 A√±os en Edad Biol√≥gica

Nuestra paciente Mar√≠a G. redujo su edad biol√≥gica en 5 a√±os 
ANTES de su cirug√≠a de plano profundo. Vea el protocolo de 
seguridad UW que garantiz√≥ su √©xito.
```

**Deep Link**: `/patient-app/testimonials` ‚Üí Casos de √©xito

**Fuente**: ERAS Complete Protocols + Handbook of Perioperative Care

**Principio**: Prueba social + Protocolo de seguridad = Confianza

---

### D√çA 5: CONEXI√ìN LOG√çSTICA (Interdrogas)

**Mensaje**:
```
üì¶ Su Kit de Preparaci√≥n Celular Est√° Listo

Su cuerpo necesita preparaci√≥n. Hemos dise√±ado su primer 
Kit de Nutrac√©uticos Epigen√©ticos. El pedido est√° listo 
para ser enviado a su puerta desde Interdrogas.
```

**Deep Link**: `/patient-app/order` ‚Üí Carrito pre-cargado

**WhatsApp**: `wa.me/576024873000` con mensaje pre-llenado

**Principio**: Preparaci√≥n ya hecha + Conveniencia = Conversi√≥n facilitada

---

### D√çA 6: ESCASEZ Y URGENCIA (Catherine Maley)

**Mensaje**:
```
üö® Solo 5 Cupos VIP Este Mes

Atenci√≥n: El Dr. Maya solo abrir√° 5 cupos de valoraci√≥n 
cu√°ntica para este mes en Cali/Quilichao. Asegure su lugar 
antes de que el sistema cierre las citas de diagn√≥stico VIP.
```

**Deep Link**: `/patient-app/booking` ‚Üí Calendario con cuenta regresiva

**Principio**: Escasez real + Cuenta regresiva = Decisi√≥n inmediata

---

### D√çA 7: EL CIERRE (Llamado a la Acci√≥n Maestro)

**Mensaje**:
```
üëë Reclame Su Soberan√≠a Biol√≥gica

Hoy es el d√≠a para reclamar su soberan√≠a biol√≥gica. 
El Dr. Maya le espera para dise√±ar su plan de inmortalidad. 
Haga clic para confirmar su cita presencial ahora.
```

**Deep Link**: WhatsApp directo con mensaje:
```
Hola Dr. Maya, quiero confirmar mi cita presencial 
para mi plan de inmortalidad
```

**Principio**: Llamado heroico + Lenguaje aspiracional = Compromiso total

---

## üéØ Motor de Segmentaci√≥n Autom√°tica

### Tabla de Reglas

| Segmento | Trigger | Chequeo | Mensaje |
|----------|---------|---------|---------|
| **Post-Op (Ogawa)** | D√≠as 3, 7, 14, 21, 30 post-cirug√≠a | Diario | "Alerta de tensi√≥n mec√°nica: Es momento de aplicar su l√°mina de silicona" |
| **Longevidad (Yu)** | 30 d√≠as sin compra | Diario | "Su reserva de antioxidantes est√° al 5%. Reabastezca en Interdrogas" |
| **Retoma (Luxury)** | 3+ meses inactivo | Semanal | "Dr. Maya tiene nueva simulaci√≥n V-Line para su perfil" |

### C√≥digo de Ejemplo

```typescript
// Evaluar reglas diariamente
const push = evaluateSegmentRules({
  id: 'patient-123',
  name: 'Mar√≠a Garc√≠a',
  segment: 'longevity',
  lastPurchase: new Date('2025-12-15'),
})

if (push) {
  sendFCMPush(['fcm-token'], push)
}
```

---

## üî• Integraci√≥n Firebase Cloud Messaging

### Setup

```typescript
import { initializeFCM, requestNotificationPermission } from '@/lib/patient-app/firebase-push'

// 1. Inicializar
await initializeFCM({
  apiKey: 'YOUR_API_KEY',
  projectId: 'maya-harmony-station',
  // ... m√°s config
})

// 2. Solicitar permiso
const granted = await requestNotificationPermission()

// 3. Obtener token
const token = await getFCMToken()

// 4. Registrar en BD
await registerFCMToken(patientId, token, {
  platform: 'web',
  os: 'Windows 11'
})
```

### Enviar Push

```typescript
await sendFCMPush(
  ['fcm-token-123'],
  {
    title: 'üî¨ El Dr. Maya Detect√≥ Algo',
    body: 'Su col√°geno ha bajado...',
    data: {
      deepLink: '/patient-app',
      pushType: 'authority'
    }
  }
)
```

---

## ‚è∞ Scheduler Autom√°tico

### Iniciar Flujo de 7 D√≠as

```typescript
import { startSevenDayFlow } from '@/lib/patient-app/seduction-scheduler'

const schedule = await startSevenDayFlow(
  'patient-123',
  'Mar√≠a Garc√≠a',
  ['fcm-token-xyz']
)

// Resultado:
// - D√≠a 1: Programado para hoy 10:00 AM
// - D√≠a 2: Programado para ma√±ana 10:00 AM
// - ... hasta D√≠a 7
```

### Chequeo Diario Autom√°tico

```typescript
// En producci√≥n: Cron Job cada d√≠a a las 10 AM
// Cloud Scheduler: "0 10 * * *"

runDailySegmentCheck(patients)
// Eval√∫a reglas de cada paciente
// Env√≠a pushes condicionales autom√°ticamente
```

---

## üìä Deep Linking

Cada notificaci√≥n abre la app en la secci√≥n correcta:

```javascript
// Service Worker (sw.js)
self.addEventListener('notificationclick', (event) => {
  const deepLink = event.notification.data?.deepLink
  
  if (deepLink.startsWith('http')) {
    // WhatsApp o URL externa
    clients.openWindow(deepLink)
  } else {
    // Navegaci√≥n interna
    clients.openWindow(deepLink)
  }
})
```

**Rutas Deep Link**:
- `/patient-app` ‚Üí Dashboard principal
- `/patient-app/order` ‚Üí Carrito Interdrogas
- `/patient-app/booking` ‚Üí Calendario de citas
- `/patient-app/maya-vision/simulation` ‚Üí Simulaci√≥n 3D
- `wa.me/576024873000?text=...` ‚Üí WhatsApp directo

---

## üé® Copywriting de Neuroventas

### Reglas de Oro

1. **NO uses**: "Compra aqu√≠", "Oferta", "Descuento"
2. **S√ç usa**: "Asegura tu evoluci√≥n", "Reclama", "Optimiza"
3. **N√∫meros espec√≠ficos**: "15% de mejora" (no "mejora significativa")
4. **Autoridad**: "Dr. Maya detect√≥" (no "Detectamos")
5. **Urgencia**: "Solo 2 cupos" (no "Cupos limitados")
6. **Aspiracional**: "Soberan√≠a biol√≥gica" (no "salud")

---

## üìà M√©tricas de √âxito

### KPIs del Engine

- **Tasa de apertura**: >60% (objetivo)
- **Click-through rate**: >40%
- **Conversi√≥n D√≠a 7**: >25%
- **Recompra nutrac√©uticos**: >70%
- **Tiempo promedio a conversi√≥n**: <10 d√≠as

### Dashboard para Dr. Maya

```typescript
const stats = await getSchedulerStats()
// {
//   activeFlows: 15,
//   scheduledPushes: 87,
//   sentToday: 34,
//   conversionRate: 68.5%
// }
```

---

## üîí Privacidad y Compliance

- ‚úÖ Permiso expl√≠cito del usuario (Notification.requestPermission)
- ‚úÖ Opt-out disponible en cualquier momento
- ‚úÖ Tokens FCM encriptados
- ‚úÖ No compartir datos con terceros
- ‚úÖ GDPR compliant (si opera en EU)

---

## üöÄ Implementaci√≥n en Producci√≥n

### Checklist

- [ ] Crear proyecto en Firebase Console
- [ ] Habilitar Cloud Messaging
- [ ] Generar VAPID keys
- [ ] Configurar Service Worker
- [ ] Crear tabla `patient_devices` en Supabase
- [ ] Configurar Cloud Scheduler (cron diario)
- [ ] Implementar analytics de notificaciones
- [ ] Testing en iOS + Android + Web
- [ ] Documentar flujos para equipo m√©dico

### Costos Estimados

- Firebase FCM: **GRATIS** hasta 10M mensajes/mes
- Cloud Scheduler: ~$0.10 USD/mes
- Supabase storage: Incluido en plan base

---

## üí° El "Efecto Presencia"

**Esto es lo que lo har√° famoso:**

El paciente siente que el Dr. Maya est√° en su bolsillo, cuidando su ADN las 24 horas. 

No es spam ‚Üí Es cuidado de ultra-lujo.

**Resultado**: Fidelizaci√≥n del 95% y referidos org√°nicos constantes.

---

**Maya Seduction Engine ¬© 2026**  
*Sistema de persuasi√≥n cient√≠fica automatizada* üß†‚ú®
